<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <link href="http://dphaener.github.io/geekwise-react/styles/app.css" rel="stylesheet" />
    <title>Geekwise Academy | ReactJS</title>
  </head>
  <body>
    <div id="wrapper">
			<main>
				<div id="content">
					<div class="innertube">
            <h1 id="day-6-authentication-protecting-routes-and-the-user-feed">Day 6: Authentication, protecting routes, and the user feed</h1>
<h2 id="setting-up">Setting up</h2>
<p>We&#39;ll begin developing on the Day 6 branch of the geekbook repository. If
you were able to follow along through the last class, you can continue along
with your own repo.</p>
<p>Or, you can clone my repo and checkout the branch:</p>
<pre><code class="lang-bash">$ git <span class="built_in">clone</span> git@github.com:dphaener/geekbook.git
$ <span class="built_in">cd</span> geekbook
$ git checkout day-6
</code></pre>
<p>If you have already cloned my repo, just fetch all the changes and then
checkout the branch:</p>
<pre><code class="lang-bash">$ <span class="built_in">cd</span> geekbook
$ git fetch origin
$ git checkout -t origin/day-6
</code></pre>
<h2 id="refactoring-the-user-creation">Refactoring the user creation</h2>
<p>Last time, we just hastily threw together the user creation in an attempt to
get it done. But now we&#39;re going to refactor it, clean it up, and do
everything the right way. The first thing we&#39;ll do is create some middleware
for Redux to handle API calls. And for this, we&#39;ll use some code from Jason.</p>
<pre><code class="lang-js"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">promiseMiddleware</span>(<span class="params"></span>) </span>{
  <span class="keyword">return</span> <span class="function">(<span class="params">next</span>) =&gt;</span> (action) =&gt; {
    <span class="keyword">const</span> { promise, type, ...rest } = action;
    <span class="keyword">if</span> (!promise) {
      <span class="keyword">return</span> next(action);
    }

    next({ ...rest, <span class="attr">type</span>: type+<span class="string">'_REQUEST'</span> });
    <span class="keyword">return</span> promise.then(
      <span class="function">(<span class="params">result</span>) =&gt;</span> next({ ...rest, result, <span class="attr">type</span>: type }),
      (error) =&gt; {
        next({ ...rest, error, <span class="attr">type</span>: type+<span class="string">'_FAILURE'</span> })
        <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);
      }
    );
  };
}
</code></pre>
<p>Let&#39;s add this to a file called <code>promise_middleware.js</code> in a new folder called
<code>app/flux</code>. Next we need to apply this middleware, so let&#39;s do that.</p>
<pre><code class="lang-js"><span class="keyword">import</span> { applyMiddleware, createStore } <span class="keyword">from</span> <span class="string">'redux'</span>
<span class="keyword">import</span> promiseMiddleware <span class="keyword">from</span> <span class="string">'~/app/flux/promise_middleware'</span>

<span class="keyword">const</span> createStoreWithMiddleware = applyMiddleware(promiseMiddleware)(createStore)
<span class="keyword">const</span> store = createStoreWithMiddleware(reducer)
</code></pre>
<h2 id="action-creators">Action Creators</h2>
<p>Up until now we&#39;ve been calling our actions by just passing in a JavaScript,
but we should be using action creators. Let&#39;s create our action creator
for our current action, and move the user creation API call into that action.</p>
<p><em>Exercise:</em> Add action creator and refactor registration component</p>
<h2 id="react-router-redux">React Router Redux</h2>
<p>Now that we&#39;ve moved our API call into the actions, we need to be able to
change our page location on a successfull registration. We&#39;ll do this by
using React Router Redux to keep our router and redux state in sync, which
will give us access to all of the <code>React Router</code> objects that we need.</p>
<p><em>Exercise:</em> Add React Router Redux and move logic into reducer from <code>Registration</code> component</p>
<h2 id="finishing-user-login">Finishing user login</h2>
<p>We left user login in a state where we were ready to handle a form submission.
Let&#39;s go ahead and handle that now.</p>
<p><em>Discuss:</em> What do we need to do in order to login?</p>
<p><em>Exercise:</em> Wire up the login logic.</p>

					</div>
				</div>
			</main>
			<nav id="nav">
				<div class="innertube">
					<h3>Classes</h3>
					<ul>
						<li><a href="http://dphaener.github.io/geekwise-react/day-1">Day 1</a></li>
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-2">Day 2</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-3">Day 3</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-4">Day 4</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-5">Day 5</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-6">Day 6</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-7">Day 7</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-8">Day 8</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-9">Day 9</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-10">Day 10</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-11">Day 11</a></li> -->
            <!-- <li><a href="http://dphaener.github.io/geekwise-react/day-12">Day 12</a></li> -->
					</ul>
					<h3>Resources</h3>
					<ul>
            <li><a target="_blank" href="http://dphaener.github.io/geekwise-react/">This Site</a></li>
            <li><a target="_blank" href="https://geekwise.slack.com/messages/G7RGZ117H/">Slack Channel</a></li>
						<li><a target="_blank" href="https://facebook.github.io/react/">React</a></li>
						<li><a target="_blank" href="https://babeljs.io/docs/learn-es2015/">ES6 Features</a></li>
						<li><a target="_blank" href="https://babeljs.io">Babel</a></li>
						<li><a target="_blank" href="https://nodejs.org/en/">NodeJS</a></li>
						<li><a target="_blank" href="https://github.com/creationix/nvm">NVM</a></li>
            <li><a target="_blank" href="https://webpack.github.io/">Webpack</a></li>
            <li><a target="_blank" href="https://facebook.github.io/flux/docs/overview.html">Flux</a></li>
            <li><a target="_blank" href="https://facebook.github.io/graphql/">GraphQL</a></li>
            <li><a target="_blank" href="https://github.com/jaredpalmer/formik">Formik</a></li>
            <li><a target="_blank" href="https://mochajs.org/">MochaJS</a></li>
            <li><a target="_blank" href="http://chaijs.com/">ChaiJS</a></li>
            <li><a target="_blank" href="http://airbnb.io/enzyme/">Enzyme</a></li>
            <li><a target="_blank" href="http://dev.apollodata.com/react/">Apollo Client - React</a></li>
					</ul>
				</div>
			</nav>
		</div>
  </body>
</html>
